---js
{
	eleventyComputed: {
		title: "{{ category.name }}",
		description: "Posts in the 11ty Bundle with the category: {{ category.name }}",
		permalink: "/categories/{{ category.name | slugify }}/",
	},
	pagination:	{
		data: "bundledata.categories",
		size: 1,
		alias: "category",
		addAllPagesToCollections: "true",
	}
}
---
<header class="main-header" data-pagefind-body>
  <div class="container">
    <h1>{{ category.name }} <data class="count" value="{{ category.count }}">{{ category.count | countLabel('post') }}</data></h1>
    {% if linkstodocs[category.name] %}
    <nav data-pagefind-ignore="all">
      <svg width="24" height="24" viewBox="0 0 24 24" aria-hidden="true">
        <use xlink:href="#icon-eleventy"></use>
      </svg>
      <a href="{{ linkstodocs[category.name] }}">{{ category.name }} - Official Docs</a>
    </nav>
{% endif %}
  </div>
</header>
<nav class="section" data-pagefind-ignore="all">
  <div class="container">
    <ul role="list" id="skip-links-years" class="skip-links">
      {% for year in bundledata.firehose | postYearsInCategory(category.name) %}
        <li><a href="#y-{{ year }}">{{ year }}</a></li>
      {% endfor %}
    </ul>
  </div>
</nav>
{% set newestPost = bundledata.firehose | postsInCategory(category.name, 0) | first %}
{% set newestPostYear = newestPost.Date | truncate(4, true, '') %}
{% set current_year = newestPostYear %}
{% set previous_year = current_year %}

<div class="section" data-pagefind-ignore="all">
  <div class="container">
    <details name="details" class="directory__layout" {% if current_year == newestPostYear %}open{% endif %}>
      <summary id="y-{{ current_year }}"><h2>{{ current_year }}</h2></summary>
      <article class="directory__grid">
    {% for item in bundledata.firehose | postsInCategory(category.name, 0) %}
  	{% set current_year = item.Date | truncate(4, true, '') %}
    {% if (current_year != previous_year) %}
      {# on year change, close the previous year's related tags #}
      </div>
    </details>
  </div>
</div>
      {% set previous_year = current_year %}
<div class="section">
  <div class="container">
    <details name="details" class="directory__layout">
      <summary id="y-{{ current_year }}"><h2>{{ current_year }}{%-include "partials/release-check.njk"-%}</h2></summary>
      <div class="directory__grid">
    {% endif %}

        {% set authorRecord = bundledata.authors | getAuthorRecord(item.Author) %}
        {% set authorIcons = authorRecord.origin | getAuthorIcons %}
        {% include "partials/postitemdetail.njk" %}
      {% endfor %}
      </div>
    </details>
  </div>
</div>
{% include "partials/releasepopovers.njk" %}
