---js
{
	eleventyComputed: {
		title: "{{ author[0] | safe }} ({{ author[1] }})",
		description: "Posts in the 11ty Bundle written by {{ author[0] }}",
		permalink: "/authors/{{ author[0] | slugify }}/",
	},
	pagination:	{
		data: "bundledata.authors",
		size: 1,
		alias: "author",
		addAllPagesToCollections: "true"
	}
}
---
{#
  Build each of the individual author pages.

  Use the most recent post from each author to pull in the following:
  - Favicon for their website
  - Link to their website
  - Link to their RSS feed
  - Social media icons, including Mastodon, Bluesky, GitHub, and LinkedIn
    (NOTE: Twitter, even if present, is not included; and yes, this is a
    personal statement.)

  Then list all posts by that author, grouped by year, with cautionary notes
  depending on the post date relative to stable releases of Eleventy.
#}

{% set latestPosts = bundledata.bundleRecords | postsByAuthor(author[0], 0) %}
<h1 title="{{ author[0] }}" data-pagefind-meta="title:{{ author[0] }} ({{ author[1] }} posts)">{{ latestPosts[0].Link | getFavicon | safe }} {{ title }}</h1>

<div class="author-links">
  {{ latestPosts[0].Link | getWebIcon | safe }}
  {{ latestPosts[0].Link | getRSSIcon | safe }}
  {{ latestPosts[0].Link | getSocialIcons | safe }}
</div>

<div class="bundleposts" data-pagefind-body>
	{% set v1cautionshown = false %}
	{% set v2cautionshown = false %}
	{% set v3cautionshown = false %}
	{% for item in latestPosts %}
  	{%- set current_year = item.Date | truncate(4, true, '') -%}
		{%- if current_year != previous_year -%}
			{%- if previous_year != "no posts yet" -%}
				</details>
			{%- endif -%}
			<details open>
			<summary>{{ current_year }}</summary>
			{%- set previous_year = current_year -%}
		{%- endif -%}
		{% if item.Date < cautioninfo.v1releasedate and not v1cautionshown %}
			{% include "partials/v1caution.njk" %}
			{% set v1cautionshown = true %}
		{% endif %}
		{% if item.Date < cautioninfo.v2releasedate and not v2cautionshown %}
			{% include "partials/v2caution.njk" %}
			{% set v2cautionshown = true %}
		{% endif %}
    {% if item.Date < cautioninfo.v3releasedate and not v3cautionshown %}
      {% include "partials/v3caution.njk" %}
      {% set v3cautionshown = true %}
    {% endif %}
		{% set postCount = bundledata.firehose | postCountByAuthor(item.Author) %}
		{% singlePostByAuthor item, author[0] %}
	{% endfor %}
</div>
